applications:
  - id: traefik
    name: Traefik
    description: Reverse Proxy
    dockerCompose: |
      version: '2'
      services:
        traefik:
          image: traefik
          env_file: ./traefik.env
          ports:
            - "80:80"
            - "8080:8080"
          volumes:
            - /var/lib/traefik/traefik.toml:/etc/traefik/traefik.toml
  - id: jeedom
    name: JeeDom
    description: Serveur Domotique
    dockerCompose: |
      jeedom:
        image: jeedom/jeedom
        links:
          - jeedom-mysql
        volumes:
          - /dev/ttyUSB0:/dev/ttyUSB0
          - /var/lib/jeedom/web:/var/www/html
        labels:
          - traefik.port=80
          - traefik.frontend.rule=PathPrefixStrip:/jeedom
        privileged: true
        restart: always
      jeedom-mysql:
        image: mysql
        volumes:
          - /var/lib/jeedom/bdd:/var/lib/mysql
        environment:
          - MYSQL_ROOT_PASSWORD=jeedom
        restart: always
  - id: nextcloud
    name: NextCloud
    description: Serveur NextCloud
    dockerCompose: |
      nextcloud:
        image: wonderfall/nextcloud
        links:
          - nextcloud-mysql:nextcloud-mysql
        environment:
          - UID=1000
          - GID=1000
        volumes:
          - /var/lib/nextcloud/data:/data
          - /var/lib/nextcloud/config:/config
          - /var/lib/nextcloud/apps:/apps2
        labels:
          - traefik.frontend.rule=PathPrefixStrip:/nextcloud
      nextcloud-mysql:
        image: mysql
        volumes:
          - /var/lib/nextcloud/bdd:/var/lib/mysql
        environment:
          - MYSQL_ROOT_PASSWORD=nextcloud
          - MYSQL_DATABASE=nextcloud
          - MYSQL_USER=nextcloud
          - MYSQL_PASSWORD=nextcloud
  - id: poste
    name: Poste.io
    description: Serveur Mail
    iptables:
      - port: 25
        protocol: tcp
      - port: 110
        protocol: tcp
      - port: 143
        protocol: tcp
      - port: 465
        protocol: tcp
      - port: 587
        protocol: tcp
      - port: 993
        protocol: tcp
      - port: 995
        protocol: tcp
    dockerCompose: |
      poste:
        image: analogic/poste.io
        volumes:
          - /var/lib/poste:/data
          - /etc/localtime:/etc/localtime:ro
        ports:
          - "25:25"
          - "110:110"
          - "143:143"
          - "465:465"
          - "587:587"
          - "993:993"
          - "995:995"
        environment:
          - HTTPS=OFF
        labels:
          - traefik.port=80
          - traefik.frontend.rule=Host:testmail.no-cloud.fr
          - traefik.frontend.entryPoints=http,https
        restart: always
